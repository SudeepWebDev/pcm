<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pilot Carrier Modulation - Demo and Presentation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
        }
        header {
            background-color: #004080;
            color: white;
            padding: 1rem;
            text-align: center;
        }
        main {
            padding: 2rem;
        }
        section {
            margin-bottom: 3rem;
        }
        iframe {
            width: 100%;
            height: 500px;
            border: none;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        label {
            display: flex;
            flex-direction: column;
            font-weight: bold;
            color: #004080;
        }
        input[type=range] {
            width: 100%;
        }
        .demo-panel {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: auto;
        }
        canvas {
            width: 100% !important;
            height: 320px !important;
        }
        ul {
            margin-top: 10px;
        }
        .math-section, .example-section {
            background: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            margin: 30px 0;
        }
        .presentation-link {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
            text-align: center;
            margin: 20px 0;
        }
        .canva-button {
            display: inline-block;
            background-color: #00C4CC;
            color: white;
            font-weight: bold;
            padding: 15px 30px;
            border-radius: 30px;
            text-decoration: none;
            font-size: 1.2rem;
            margin-top: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .canva-button:hover {
            background-color: #00A4AC;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        /* Hamburger Menu Styles */
        .nav-toggle {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
            padding: 10px;
            background: rgba(0, 64, 128, 0.8);
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 24px;
            width: 30px;
        }
        
        .nav-toggle span {
            display: block;
            width: 100%;
            height: 3px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .nav-toggle.active span:nth-child(1) {
            transform: translateY(10px) rotate(45deg);
        }
        
        .nav-toggle.active span:nth-child(2) {
            opacity: 0;
        }
        
        .nav-toggle.active span:nth-child(3) {
            transform: translateY(-10px) rotate(-45deg);
        }
        
        .side-nav {
            position: fixed;
            top: 0;
            right: -300px;
            width: 280px;
            height: 100%;
            background: #004080;
            z-index: 999;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.2);
            transition: right 0.3s ease;
            padding-top: 70px;
        }
        
        .side-nav.active {
            right: 0;
        }
        
        .side-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .side-nav ul li {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .side-nav ul li a {
            display: block;
            padding: 15px 20px;
            color: white;
            text-decoration: none;
            font-weight: bold;
            transition: background 0.3s;
        }
        
        .side-nav ul li a:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
        }
        
        @media (min-width: 992px) {
            .nav-toggle {
                display: none;
            }
        }
        .real-time-calcs {
            margin-top: 30px;
            border-top: 1px dashed #aaa;
            padding-top: 20px;
        }
        .calculation-box {
            background-color: #f0f8ff;
            padding: 15px 20px;
            border-radius: 8px;
            border-left: 4px solid #004080;
        }
        .calculation-box strong {
            color: #004080;
        }
        .calculation-box .math-formula {
            background-color: #fff;
        }
        #calcCarrierFreq, #calcPilotFreq, #calcMsgFreq,
        #eqMsgFreq, #eqMsgFreq2, #eqMsgFreq3, 
        #eqCarrierFreq, #eqCarrierFreq2, #eqPilotFreq,
        #powerEfficiency, #powerRatio, #msgBandwidth,
        #pilotComponents, #noPilotComponents {
            font-weight: bold;
            color: #d04000;
            transition: background-color 0.3s;
            padding: 2px 4px;
        }
        .highlight {
            background-color: #fffacd;
        }
    </style>
</head>
<body>

<!-- Hamburger menu toggle button -->
<div class="nav-toggle" id="navToggle">
    <span></span>
    <span></span>
    <span></span>
</div>

<!-- Overlay for when menu is open -->
<div class="overlay" id="overlay"></div>

<!-- Side navigation menu -->
<nav class="side-nav" id="sideNav">
    <ul>
        <li><a href="#presentationSection">Presentation</a></li>
        <li><a href="#demoPanel">Interactive Demo</a></li>
        <li><a href="#exampleSection">FM Radio Example</a></li>
        <li><a href="#mathSection">Mathematical Model</a></li>
        <li><a href="#quizSection">Knowledge Quiz</a></li>
        <li><a href="#referencesSection">References</a></li>
    </ul>
</nav>

<header>
    <h1>Pilot Carrier Modulation</h1>
    <p>Presentation and Interactive Demo</p>
</header>

<main>
    <section id="presentationSection">
        <h2>Presentation (from Canva)</h2>
        <!-- Canva iframe with fallback -->
        <div id="canvaContainer" style="position: relative; width: 100%; height: 0; padding-top: 56.2500%;
        padding-bottom: 0; box-shadow: 0 2px 8px 0 rgba(63,69,81,0.16); margin-top: 1.6em; margin-bottom: 0.9em; overflow: hidden;
        border-radius: 8px; will-change: transform;">
         <iframe id="canvaFrame" loading="lazy" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0;margin: 0;"
           src="https://www.canva.com/design/DAGlRwL0oaE/_ZFLKVZBI8cRKGKePoQhLw/view?embed" allowfullscreen="allowfullscreen" allow="fullscreen">
         </iframe>
       </div>
       
       <!-- Fallback that will be shown if iframe fails to load -->
       <div id="canvaFallback" class="presentation-link" style="display: none;">
           <p>The embedded presentation couldn't be loaded due to Content Security Policy restrictions.</p>
           <p>Please click the button below to view the presentation in a new tab:</p>
           <a href="https://www.canva.com/design/DAGlRwL0oaE/_ZFLKVZBI8cRKGKePoQhLw/view" target="_blank" class="canva-button">
               View Presentation
           </a>
       </div>
       
       <a href="https:&#x2F;&#x2F;www.canva.com&#x2F;design&#x2F;DAGlRwL0oaE&#x2F;_ZFLKVZBI8cRKGKePoQhLw&#x2F;view?utm_content=DAGlRwL0oaE&amp;utm_campaign=designshare&amp;utm_medium=embeds&amp;utm_source=link" target="_blank" rel="noopener">Pilot Carrier Modulation</a> by SUDEEP SINGH
    </section>

    <section>
        <div class="demo-panel" id="demoPanel">
            <h2 style="color:#1a4e8a;">Interactive Pilot Carrier Modulation Demo</h2>
            <div class="controls">
                <label>
                    Carrier Frequency (Hz):
                    <input type="range" id="carrierFreq" min="100" max="2000" value="1000">
                    <span id="carrierFreqVal">1000</span>
                </label>
                <label>
                    Pilot Frequency (Hz):
                    <input type="range" id="pilotFreq" min="10" max="500" value="100">
                    <span id="pilotFreqVal">100</span>
                </label>
                <label>
                    Message Frequency (Hz):
                    <input type="range" id="msgFreq" min="1" max="100" value="10">
                    <span id="msgFreqVal">10</span>
                </label>
            </div>
            <canvas id="modulationChart"></canvas>
            <canvas id="modulationChartNoPilot" style="margin-top:30px;"></canvas>
            <div style="margin-top:18px;color:#1a4e8a;font-size:1.05rem;">
                <b>How to use:</b> Move the sliders to change the carrier, pilot, and message frequencies.<br>
                The charts update in real time to show modulation <i>with</i> and <i>without</i> pilot carrier.
            </div>
        </div>
    </section>

    <section class="example-section" id="exampleSection">
        <h2>Real Example: FM Radio Transmission</h2>
        <p>In FM radio broadcasting, a pilot tone at 19 kHz is transmitted alongside the main stereo signal to help receivers decode the left and right audio channels. The carrier frequency might be around 100 MHz for FM radio, while message signals (audio) range from 20 Hz to 15 kHz.</p>
        <p><b>Example Parameters:</b>
        <ul>
            <li>Carrier Frequency (fc) ≈ 1000 Hz (scaled down for demo)</li>
            <li>Pilot Frequency (fp) ≈ 100 Hz</li>
            <li>Message Frequency (fm) ≈ 10 Hz</li>
        </ul>
        </p>
        <p>This example shows how a pilot signal is essential for synchronization and signal demodulation in real-world applications like FM broadcasting.</p>
    </section>

    <section class="math-section" id="mathSection">
        <h2>Mathematical Model Verification</h2>
        <p>The modulated signal <b>with pilot</b> is given by:</p>
        <p style="font-family:monospace;">s(t) = (1 + m(t)) × cos(2πf<sub>c</sub>t) + 0.2 × cos(2πf<sub>p</sub>t)</p>
        <p>where <i>m(t)</i> = sin(2πf<sub>m</sub>t)</p>

        <p>Without the pilot, the modulated signal simplifies to:</p>
        <p style="font-family:monospace;">s(t) = (1 + m(t)) × cos(2πf<sub>c</sub>t)</p>

        <p>✅ Our simulation plots follow these formulas correctly:</p>
        <ul>
            <li>"With Pilot" includes an extra sinusoidal component at pilot frequency.</li>
            <li>"Without Pilot" shows only the message-modulated carrier.</li>
        </ul>

        <!-- Real-time calculations section -->
        <div id="realTimeCalcs" class="real-time-calcs">
            <h3>Real-time Calculations Based on Current Parameters</h3>
            <div class="calculation-box">
                <p><strong>Current Parameters:</strong></p>
                <ul>
                    <li>Carrier Frequency (f<sub>c</sub>): <span id="calcCarrierFreq">1000</span> Hz</li>
                    <li>Pilot Frequency (f<sub>p</sub>): <span id="calcPilotFreq">100</span> Hz</li>
                    <li>Message Frequency (f<sub>m</sub>): <span id="calcMsgFreq">10</span> Hz</li>
                </ul>
                
                <p><strong>Signal Equations with Current Values:</strong></p>
                <div class="math-formula">
                    <p>m(t) = sin(2π × <span id="eqMsgFreq">10</span> × t)</p>
                    <p>s<sub>with-pilot</sub>(t) = (1 + sin(2π × <span id="eqMsgFreq2">10</span> × t)) × cos(2π × <span id="eqCarrierFreq">1000</span> × t) + 0.2 × cos(2π × <span id="eqPilotFreq">100</span> × t)</p>
                    <p>s<sub>without-pilot</sub>(t) = (1 + sin(2π × <span id="eqMsgFreq3">10</span> × t)) × cos(2π × <span id="eqCarrierFreq2">1000</span> × t)</p>
                </div>
                
                <p><strong>Power Calculations:</strong></p>
                <div class="math-formula">
                    <p>For Pilot-Carrier SSB, with pilot attenuated by 16 dB:</p>
                    <p>Power efficiency = <span id="powerEfficiency">97.6</span>%</p>
                    <p>Ratio of pilot power to sideband power: 1:<span id="powerRatio">40</span></p>
                </div>
                
                <p><strong>Frequency Domain Analysis:</strong></p>
                <div class="math-formula">
                    <p>Message bandwidth = <span id="msgBandwidth">10</span> Hz</p>
                    <p>With Pilot: Components at f<sub>c</sub> ± f<sub>m</sub> and f<sub>p</sub> = <span id="pilotComponents">1000 ± 10 Hz, 100 Hz</span></p>
                    <p>Without Pilot: Components only at f<sub>c</sub> ± f<sub>m</sub> = <span id="noPilotComponents">1000 ± 10 Hz</span></p>
                </div>
            </div>
        </div>
    </section>

   <!-- Quiz Section -->
    <section class="quiz-section" id="quizSection">
        <h2>Test Your Knowledge</h2>
        <div class="quiz-container">
            <div class="quiz-item">
                <p><strong>1. What is the main purpose of including a pilot carrier in SSB?</strong></p>
                <div class="quiz-options">
                    <div class="option" data-correct="false">To increase transmission power</div>
                    <div class="option" data-correct="true">To provide a frequency reference for demodulation</div>
                    <div class="option" data-correct="false">To boost audio quality</div>
                    <div class="option" data-correct="false">To increase bandwidth</div>
                </div>
                <div class="feedback"></div>
            </div>
            
            <div class="quiz-item">
                <p><strong>2. By how much is the pilot carrier typically attenuated compared to full carrier?</strong></p>
                <div class="quiz-options">
                    <div class="option" data-correct="false">3-6 dB</div>
                    <div class="option" data-correct="false">8-12 dB</div>
                    <div class="option" data-correct="true">16-26 dB</div>
                    <div class="option" data-correct="false">30-40 dB</div>
                </div>
                <div class="feedback"></div>
            </div>
            
            <div class="quiz-item">
                <p><strong>3. What's the typical power efficiency of a pilot-carrier SSB system?</strong></p>
                <div class="quiz-options">
                    <div class="option" data-correct="false">33%</div>
                    <div class="option" data-correct="false">50%</div>
                    <div class="option" data-correct="false">75%</div>
                    <div class="option" data-correct="true">97-99%</div>
                </div>
                <div class="feedback"></div>
            </div>
            
            <div class="quiz-item">
                <p><strong>4. Which system uses half the bandwidth of conventional AM?</strong></p>
                <div class="quiz-options">
                    <div class="option" data-correct="true">Pilot-Carrier SSB</div>
                    <div class="option" data-correct="false">Double-sideband AM</div>
                    <div class="option" data-correct="false">FM</div>
                    <div class="option" data-correct="false">PM</div>
                </div>
                <div class="feedback"></div>
            </div>
        </div>
    </section>

    <!-- References Section -->
    <section class="references-section" id="referencesSection">
        <h2>References</h2>
        <div class="content-block">
            <ol class="reference-list">
                <li>Proakis, John G., <em>Digital Communications</em>, McGraw Hill, 5th Edition, 2008.</li>
                <li>Haykin, Simon, <em>Communication Systems</em>, 5th Edition, Wiley, 2013.</li>
                <li>Lathi, B. P., <em>Modern Digital and Analog Communication Systems</em>, Oxford University Press, 4th Edition, 2009.</li>
                <li>Stremler, Ferrel G., <em>Introduction to Communication Systems</em>, 3rd Edition, Addison-Wesley, 1990.</li>
            </ol>
            <p class="citation-note">The technical content on Pilot Carrier Modulation presented in this document draws from these authoritative sources in the field of communications engineering.</p>
        </div>
    </section>
</main>

<style>
    /* Additional styles for new sections */
    .technical-section {
        background: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        margin: 30px 0;
    }
    
    .content-block {
        margin-bottom: 25px;
    }
    
    .math-formula {
        background-color: #f8f9fa;
        padding: 10px 15px;
        border-left: 4px solid #004080;
        margin: 15px 0;
        font-family: 'Times New Roman', Times, serif;
    }
    
    .comparison-table {
        width: 100%;
        border-collapse: collapse;
        margin: 15px 0;
    }
    
    .comparison-table th, .comparison-table td {
        border: 1px solid #ddd;
        padding: 8px 12px;
        text-align: left;
    }
    
    .comparison-table th {
        background-color: #f2f2f2;
    }
    
    .comparison-table tr:nth-child(even) {
        background-color: #f9f9f9;
    }
    
    /* Quiz Styles */
    .quiz-section {
        background: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        margin: 30px 0;
    }
    
    .quiz-container {
        max-width: 800px;
        margin: 0 auto;
    }
    
    .quiz-item {
        margin-bottom: 25px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 15px;
        background-color: #f9f9f9;
    }
    
    .quiz-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
    }
    
    .option {
        padding: 10px 15px;
        background-color: #e9ecef;
        border: 1px solid #ced4da;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .option:hover {
        background-color: #dee2e6;
    }
    
    .option.selected {
        background-color: #b8daff;
        border-color: #7abaff;
    }
    
    .option.correct {
        background-color: #d4edda;
        border-color: #c3e6cb;
        color: #155724;
    }
    
    .option.incorrect {
        background-color: #f8d7da;
        border-color: #f5c6cb;
        color: #721c24;
    }
    
    .feedback {
        margin-top: 10px;
        padding: 8px 0;
        font-weight: bold;
        min-height: 20px;
    }
    
    .feedback.correct {
        color: #155724;
    }
    
    .feedback.incorrect {
        color: #721c24;
    }
    
    /* Reference Styles */
    .references-section {
        background: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        margin: 30px 0;
    }
    
    .reference-list {
        padding-left: 25px;
        line-height: 1.6;
    }
    
    .reference-list li {
        margin-bottom: 10px;
        color: #333;
    }
    
    .reference-list em {
        font-style: italic;
    }
    
    .citation-note {
        margin-top: 20px;
        font-style: italic;
        color: #555;
        border-top: 1px solid #eee;
        padding-top: 15px;
    }
    
    /* Footer Styles */
    .attribution-footer {
        background-color: #004080;
        color: white;
        padding: 2rem;
        margin-top: 3rem;
    }
    
    .attribution-container {
        max-width: 1000px;
        margin: 0 auto;
        display: flex;
        justify-content: space-around;
        flex-wrap: wrap;
    }
    
    .attribution-section {
        padding: 1rem;
        min-width: 250px;
    }
    
    .attribution-section h3 {
        margin-top: 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        padding-bottom: 10px;
    }
    
    .attribution-section p {
        margin: 5px 0;
    }
    
    @media (max-width: 600px) {
        .attribution-container {
            flex-direction: column;
        }
        
        .attribution-section {
            text-align: center;
        }
    }
</style>

<!-- Footer with attribution -->
<footer class="attribution-footer">
    <div class="attribution-container">
        <div class="attribution-section">
            <h3>Created By</h3>
            <p>Sudeep Kumar Singh</p>
            <p>22/28021</p>
            <p>Paper: Communication System</p>
            <p>Bsc Computer Science Hons</p>
            <p>Atma Ram Santan Dharma College, DU</p>
        </div>
        <div class="attribution-section">
            <h3>Submitted to</h3>
            <p>Dr. Nisha Jha</p>
            <p>Department of Electronics</p>
            <p>Atma Ram Santan Dharma College</p>
            <p>University of Delhi</p>
        </div>
    </div>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Hamburger menu functionality
        const navToggle = document.getElementById('navToggle');
        const sideNav = document.getElementById('sideNav');
        const overlay = document.getElementById('overlay');
        
        navToggle.addEventListener('click', toggleNav);
        overlay.addEventListener('click', closeNav);
        
        // Close menu when clicking a nav link (for better mobile UX)
        document.querySelectorAll('.side-nav a').forEach(link => {
            link.addEventListener('click', closeNav);
        });
        
        function toggleNav() {
            navToggle.classList.toggle('active');
            sideNav.classList.toggle('active');
            
            if (sideNav.classList.contains('active')) {
                document.body.style.overflow = 'hidden'; // Prevent scrolling while menu is open
                overlay.style.display = 'block';
            } else {
                closeNav();
            }
        }
        
        function closeNav() {
            navToggle.classList.remove('active');
            sideNav.classList.remove('active');
            document.body.style.overflow = '';
            overlay.style.display = 'none';
        }
        
        // Check if Canva iframe loads properly
        const canvaFrame = document.getElementById('canvaFrame');
        const canvaFallback = document.getElementById('canvaFallback');
        const canvaContainer = document.getElementById('canvaContainer');
        
        // Set a timeout to check if iframe loaded
        setTimeout(function() {
            try {
                // Try to access iframe content - this will fail if CSP blocks it
                const frameContent = canvaFrame.contentWindow || canvaFrame.contentDocument;
                if (!frameContent) {
                    showFallback();
                }
            } catch (e) {
                // If any error occurs, show fallback
                showFallback();
            }
        }, 3000); // Check after 3 seconds
        
        // Also listen for iframe load errors
        canvaFrame.onerror = showFallback;
        
        function showFallback() {
            canvaContainer.style.display = 'none';
            canvaFallback.style.display = 'block';
        }
        
        // Existing code for the demo functionality
        const carrierFreq = document.getElementById('carrierFreq');
        const pilotFreq = document.getElementById('pilotFreq');
        const msgFreq = document.getElementById('msgFreq');
        const carrierFreqVal = document.getElementById('carrierFreqVal');
        const pilotFreqVal = document.getElementById('pilotFreqVal');
        const msgFreqVal = document.getElementById('msgFreqVal');
// GE/:532  Uncaught ReferenceError: calcElements is not defined
// at updateMathCalculations (GE/:532:33)
//     at updateLabels (GE/:526:13)
//     at HTMLDocument.<anonymous> (GE/:636:13)
// 50GE/:532  Uncaught ReferenceError: calcElements is not defined
//     at updateMathCalculations (GE/:532:33)
//     at updateLabels (GE/:526:13)

const calcElements = {
            carrierFreq: document.getElementById('calcCarrierFreq'),
            pilotFreq: document.getElementById('calcPilotFreq'),
            msgFreq: document.getElementById('calcMsgFreq'),
            eqMsgFreq: document.getElementById('eqMsgFreq'),
            eqMsgFreq2: document.getElementById('eqMsgFreq2'),
            eqMsgFreq3: document.getElementById('eqMsgFreq3'),
            eqCarrierFreq: document.getElementById('eqCarrierFreq'),
            eqCarrierFreq2: document.getElementById('eqCarrierFreq2'),
            eqPilotFreq: document.getElementById('eqPilotFreq'),
            powerEfficiency: document.getElementById('powerEfficiency'),
            powerRatio: document.getElementById('powerRatio'),
            msgBandwidth: document.getElementById('msgBandwidth'),
            pilotComponents: document.getElementById('pilotComponents'),
            noPilotComponents: document.getElementById('noPilotComponents')
        };
        function updateLabels() {
            carrierFreqVal.textContent = carrierFreq.value;
            pilotFreqVal.textContent = pilotFreq.value;
            msgFreqVal.textContent = msgFreq.value;
            updateMathCalculations();
        }
        function updateMathCalculations() {
            const fc = parseInt(carrierFreq.value);
            const fp = parseInt(pilotFreq.value);
            const fm = parseInt(msgFreq.value);
            updateWithHighlight(calcElements.carrierFreq, fc);
            updateWithHighlight(calcElements.pilotFreq, fp);
            updateWithHighlight(calcElements.msgFreq, fm);
            updateWithHighlight(calcElements.eqCarrierFreq, fc);
            updateWithHighlight(calcElements.eqCarrierFreq2, fc);
            updateWithHighlight(calcElements.eqPilotFreq, fp);
            updateWithHighlight(calcElements.eqMsgFreq, fm);
            updateWithHighlight(calcElements.eqMsgFreq2, fm);
            updateWithHighlight(calcElements.eqMsgFreq3, fm);
            const powerRatio = Math.round(Math.pow(10, 16/10));
            const efficiency = (1 / (1 + 1/powerRatio) * 100).toFixed(1);
            updateWithHighlight(calcElements.powerEfficiency, efficiency);
            updateWithHighlight(calcElements.powerRatio, powerRatio);
            updateWithHighlight(calcElements.msgBandwidth, fm);
            updateWithHighlight(calcElements.pilotComponents, `${fc} ± ${fm} Hz, ${fp} Hz`);
            updateWithHighlight(calcElements.noPilotComponents, `${fc} ± ${fm} Hz`);
        }
        function updateWithHighlight(element, value) {
            if (element) {
                if (element.textContent != value) {
                    element.textContent = value;
                    element.classList.add('highlight');
                    setTimeout(() => {
                        element.classList.remove('highlight');
                    }, 1000);
                }
            }
        }

        function generateSignals() {
            const fs = 10000; // sample rate
            const t = [];
            const N = 1000;
            for (let i = 0; i < N; i++) t.push(i / fs);

            const fc = parseFloat(carrierFreq.value);
            const fp = parseFloat(pilotFreq.value);
            const fm = parseFloat(msgFreq.value);

            const msg = t.map(time => Math.sin(2 * Math.PI * fm * time));
            const carrier = t.map(time => Math.cos(2 * Math.PI * fc * time));
            const pilot = t.map(time => 0.2 * Math.cos(2 * Math.PI * fp * time));

            const modulatedWithPilot = t.map((time, i) => (1 + msg[i]) * carrier[i] + pilot[i]);
            const modulatedWithoutPilot = t.map((time, i) => (1 + msg[i]) * carrier[i]);

            return { t, msg, carrier, pilot, modulatedWithPilot, modulatedWithoutPilot };
        }

        let chart1 = null;
        let chart2 = null;
        function plot() {
            const ctx1 = document.getElementById('modulationChart');
            const ctx2 = document.getElementById('modulationChartNoPilot');
            if (!ctx1 || !ctx2 || !ctx1.getContext || !ctx2.getContext) return;
            const { t, msg, carrier, pilot, modulatedWithPilot, modulatedWithoutPilot } = generateSignals();
            const labels = t.map(time => time.toFixed(4));

            if (chart1) chart1.destroy();
            if (chart2) chart2.destroy();

            chart1 = new Chart(ctx1.getContext('2d'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Message', data: msg, borderColor: 'blue', fill: false, pointRadius: 0 },
                        { label: 'Carrier', data: carrier, borderColor: 'green', fill: false, pointRadius: 0 },
                        { label: 'Pilot', data: pilot, borderColor: 'orange', fill: false, pointRadius: 0 },
                        { label: 'Modulated (With Pilot)', data: modulatedWithPilot, borderColor: 'red', fill: false, pointRadius: 0 }
                    ]
                },
                options: {
                    animation: false,
                    elements: { line: { tension: 0 } },
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x: { display: false }, y: { min: -2, max: 2 } }
                }
            });

            chart2 = new Chart(ctx2.getContext('2d'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Modulated (Without Pilot)', data: modulatedWithoutPilot, borderColor: 'purple', fill: false, pointRadius: 0 }
                    ]
                },
                options: {
                    animation: false,
                    elements: { line: { tension: 0 } },
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x: { display: false }, y: { min: -2, max: 2 } }
                }
            });
        }

        if (carrierFreq && pilotFreq && msgFreq) {
            carrierFreq.oninput = pilotFreq.oninput = msgFreq.oninput = function() {
                updateLabels();
                plot();
            };
            updateLabels();
            setTimeout(plot, 200);
        }
        updateMathCalculations();

        // Quiz functionality
        const quizItems = document.querySelectorAll('.quiz-item');
        
        quizItems.forEach(item => {
            const options = item.querySelectorAll('.option');
            const feedback = item.querySelector('.feedback');
            
            options.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove previous selections
                    options.forEach(opt => {
                        opt.classList.remove('selected', 'correct', 'incorrect');
                    });
                    
                    // Mark this option as selected
                    this.classList.add('selected');
                    
                    // Check if correct
                    const isCorrect = this.getAttribute('data-correct') === 'true';
                    
                    if (isCorrect) {
                        this.classList.add('correct');
                        feedback.textContent = '✓ Correct!';
                        feedback.className = 'feedback correct';
                    } else {
                        this.classList.add('incorrect');
                        feedback.textContent = '✗ Incorrect. Try again.';
                        feedback.className = 'feedback incorrect';
                        
                        // Optionally show the correct answer
                        options.forEach(opt => {
                            if (opt.getAttribute('data-correct') === 'true') {
                                opt.classList.add('correct');
                            }
                        });
                    }
                });
            });
        });
    });
</script>

</body>
</html>
